function Transm = ozoneTransmission(zenithAngle_deg, dobsonUnits, Lam, waveUnits)
    % Input:  - Lam (double array): Wavelength array  
    %         - zenithAngle_deg (double): Zenith angle in degrees [0, 90] (default: 55.18)
    %         - dobsonUnits (double): Ozone column in Dobson Units (default: 300)
    %         - waveUnits (string): Wavelength units (default: 'nm')
    % Output: - Transm (double array): Transmission values (0-1)
    % Reference: Gueymard, C. A. (2019). Solar Energy, 187, 233-253.
    % Author: D. Kovaleva (Sep 2025) - Fast direct calculation version
    % Example: Trans = astro.transmission.ozoneTransmission(55.18, 300);
    
    arguments
        zenithAngle_deg  = 30
        dobsonUnits  = 300
        Lam = linspace(300,1100,401);      % added for uniformity, O3UV absorption data already interpolated to the net
        waveUnits = "nm";                  % for uniformity
    end
    %O3UV absorption
    O3UV_cross_section = getO3UVcrossSection;

   % Checkup for zenith angle value correctness
    if zenithAngle_deg > 90 || zenithAngle_deg < 0
        error('Zenith angle out of range [0, 90] deg');
    end
   
    % Calculate airmass 
    Am_ = astro.transmission.airmassSMARTS(zenithAngle_deg).ozone;
       
    % Loschmidt scaling
    Absorption_coeff = constant.Loschmidt * O3UV_cross_section;
    
    % Convert Dobson units to atm-cm
    Ozone_atm_cm = dobsonUnits * 0.001;

    % Calculate optical depth
    Tau_ozone = Absorption_coeff * Ozone_atm_cm;
    
    % Calculate transmission
    Transm = exp(-Am_ .* Tau_ozone);
end

function O3UV_cross_section = getO3UVcrossSection()
    O3UV_cross_section = [
        3.5389000000e-19
        2.7236000000e-19
        2.0887000000e-19
        1.5586000000e-19
        1.1714000000e-19
        8.5446000000e-20
        6.5288000000e-20
        5.1341000000e-20
        3.7870000000e-20
        2.9973000000e-20
        2.5923000000e-20
        1.9056000000e-20
        8.0071000000e-21
        7.4150000000e-21
        1.0649000000e-20
        3.3209000000e-21
        2.4500000000e-21
        3.8313000000e-21
        8.9002000000e-22
        1.3393000000e-21
        1.2834000000e-21
        2.8706000000e-22
        1.1126000000e-21
        2.0352000000e-22
        1.7456000000e-22
        8.2669000000e-23
        2.0330000000e-22
        3.5427000000e-23
        2.8979000000e-23
        1.9524000000e-23
        4.6173000000e-23
        8.6807000000e-24
        6.4067000000e-24
        7.3361000000e-24
        4.8853000000e-24
        4.1974000000e-24
        2.4983000000e-24
        3.7536000000e-24
        3.0183000000e-24
        2.5502000000e-24
        3.3701000000e-24
        4.2338000000e-24
        4.1762000000e-24
        4.3626000000e-24
        5.3197000000e-24
        6.3530000000e-24
        6.6900000000e-24
        7.2800000000e-24
        7.9800000000e-24
        6.1000000000e-24
        6.7200000000e-24
        7.6100000000e-24
        7.6500000000e-24
        8.4914000000e-24
        1.5558000000e-23
        1.9060000000e-23
        1.8184000000e-23
        1.6968000000e-23
        2.4589000000e-23
        2.9077000000e-23
        2.8461000000e-23
        3.8191000000e-23
        5.5955000000e-23
        6.3975000000e-23
        5.7065000000e-23
        5.5908000000e-23
        7.2672000000e-23
        8.0114000000e-23
        7.8957000000e-23
        9.8306000000e-23
        1.3438000000e-22
        1.6859000000e-22
        1.6854000000e-22
        1.4372000000e-22
        1.5096000000e-22
        1.8607000000e-22
        1.9294000000e-22
        1.9098000000e-22
        2.2787000000e-22
        2.9655000000e-22
        3.7897000000e-22
        4.0957000000e-22
        3.6558000000e-22
        3.3185000000e-22
        3.6854000000e-22
        4.1724000000e-22
        4.1934000000e-22
        4.3215000000e-22
        5.1441000000e-22
        6.3481000000e-22
        7.8135000000e-22
        8.6986000000e-22
        8.4108000000e-22
        7.6533000000e-22
        7.5851000000e-22
        8.1931000000e-22
        8.6822000000e-22
        8.8194000000e-22
        9.2532000000e-22
        1.0513000000e-21
        1.2323000000e-21
        1.4388000000e-21
        1.6142000000e-21
        1.6706000000e-21
        1.6232000000e-21
        1.5610000000e-21
        1.5691000000e-21
        1.6398000000e-21
        1.7184000000e-21
        1.7788000000e-21
        1.8497000000e-21
        1.9694000000e-21
        2.1066000000e-21
        2.3004000000e-21
        2.5125000000e-21
        2.6794000000e-21
        2.8129000000e-21
        2.8604000000e-21
        2.8527000000e-21
        2.8626000000e-21
        2.9342000000e-21
        3.0507000000e-21
        3.1680000000e-21
        3.2520000000e-21
        3.3190000000e-21
        3.3774000000e-21
        3.4418000000e-21
        3.5245000000e-21
        3.6343000000e-21
        3.7938000000e-21
        3.9905000000e-21
        4.1887000000e-21
        4.3531000000e-21
        4.4770000000e-21
        4.6005000000e-21
        4.7111000000e-21
        4.8207000000e-21
        4.8615000000e-21
        4.8321000000e-21
        4.7548000000e-21
        4.6638000000e-21
        4.5688000000e-21
        4.5049000000e-21
        4.4699000000e-21
        4.4636000000e-21
        4.4900000000e-21
        4.5759000000e-21
        4.7354000000e-21
        4.9059000000e-21
        5.0862000000e-21
        5.2306000000e-21
        5.2823000000e-21
        5.2475000000e-21
        5.1373100000e-21
        4.9699000000e-21
        4.7837400000e-21
        4.5963000000e-21
        4.4205600000e-21
        4.2638800000e-21
        4.1258500000e-21
        4.0133000000e-21
        3.9177600000e-21
        3.8301700000e-21
        3.7346300000e-21
        3.6324200000e-21
        3.5245900000e-21
        3.4179500000e-21
        3.3056500000e-21
        3.1843200000e-21
        3.0606600000e-21
        2.9343900000e-21
        2.8159700000e-21
        2.7053400000e-21
        2.6119100000e-21
        2.5217800000e-21
        2.4407500000e-21
        2.3624700000e-21
        2.2816400000e-21
        2.2013300000e-21
        2.1229300000e-21
        2.0472900000e-21
        1.9773500000e-21
        1.9018600000e-21
        1.8180700000e-21
        1.7267800000e-21
        1.6550700000e-21
        1.5770200000e-21
        1.5040300000e-21
        1.4375100000e-21
        1.3750900000e-21
        1.3209500000e-21
        1.2815600000e-21
        1.2449200000e-21
        1.2019100000e-21
        1.1475700000e-21
        1.0916700000e-21
        1.0385100000e-21
        9.8759200000e-22
        9.3778500000e-22
        8.9050900000e-22
        8.4827200000e-22
        8.1156900000e-22
        7.8094500000e-22
        7.5553300000e-22
        7.3200500000e-22
        7.1060100000e-22
        6.9416800000e-22
        6.8208500000e-22
        6.6687300000e-22
        6.3905300000e-22
        6.0139800000e-22
        5.6496100000e-22
        5.3497300000e-22
        5.0932000000e-22
        4.7951800000e-22
        4.5663500000e-22
        4.3698600000e-22
        4.2354900000e-22
        4.1497900000e-22
        4.0790900000e-22
        4.0430200000e-22
        4.0594700000e-22
        4.1150300000e-22
        4.1648100000e-22
        4.1048400000e-22
        3.8601500000e-22
        3.5006700000e-22
        3.1470400000e-22
        2.9150600000e-22
        2.7582500000e-22
        2.6498900000e-22
        2.6184000000e-22
        2.5289000000e-22
        2.4751000000e-22
        2.4834000000e-22
        2.5266000000e-22
        2.6258000000e-22
        2.8323000000e-22
        3.0898000000e-22
        3.2956000000e-22
        3.2968000000e-22
        3.0674000000e-22
        2.7392000000e-22
        2.4138000000e-22
        2.1896000000e-22
        2.0201000000e-22
        1.8607000000e-22
        1.7098000000e-22
        1.6139000000e-22
        1.5509000000e-22
        1.4965000000e-22
        1.4688000000e-22
        1.4637000000e-22
        1.5283000000e-22
        1.6806000000e-22
        1.8568000000e-22
        2.0567000000e-22
        2.2376000000e-22
        2.3337000000e-22
        2.2938000000e-22
        2.1017000000e-22
        1.8162000000e-22
        1.5104000000e-22
        1.2605000000e-22
        1.0598000000e-22
        9.1097000000e-23
        8.1500000000e-23
        7.5892000000e-23
        7.2641000000e-23
        7.2026000000e-23
        7.2871000000e-23
        7.6657000000e-23
        8.1558000000e-23
        8.9620000000e-23
        1.0352000000e-22
        1.2416000000e-22
        1.5030000000e-22
        1.5692000000e-22
        1.4511000000e-22
        1.3065000000e-22
        1.1523000000e-22
        9.4180000000e-23
        7.5266000000e-23
        6.2350000000e-23
        5.2552000000e-23
        4.4569000000e-23
        3.9604000000e-23
        3.6539000000e-23
        3.5749000000e-23
        3.6230000000e-23
        3.7867000000e-23
        4.1377000000e-23
        4.4756000000e-23
        5.0400000000e-23
        5.2369000000e-23
        5.3413000000e-23
        4.9411000000e-23
        5.4773000000e-23
        6.5806000000e-23
        6.8598000000e-23
        6.4400000000e-23
        5.6585000000e-23
        4.8221000000e-23
        3.8967000000e-23
        3.0816000000e-23
        2.5038000000e-23
        2.0526000000e-23
        1.7871000000e-23
        1.6061000000e-23
        1.4594000000e-23
        1.4918000000e-23
        1.3453000000e-23
        1.3554000000e-23
        1.4178000000e-23
        1.5145000000e-23
        1.5514000000e-23
        1.5379000000e-23
        1.3945000000e-23
        1.6998000000e-23
        2.3622000000e-23
        3.1864000000e-23
        4.1432000000e-23
        4.6913000000e-23
        4.2849000000e-23
        3.3375000000e-23
        2.2522000000e-23
        1.7944000000e-23
        1.3000000000e-23
        1.2891000000e-23
        1.0888000000e-23
        8.9650000000e-24
        7.0731000000e-24
        7.0829000000e-24
        6.1242000000e-24
        4.6446000000e-24
        2.7059000000e-24
        2.1206000000e-24
        1.7698000000e-24
        1.1182000000e-24
        1.5399000000e-24
        1.7446000000e-24
        1.9815000000e-24
        2.6967000000e-24
        5.0556000000e-24
        1.0530000000e-23
        1.9734000000e-23
        3.3886000000e-23
        2.6317000000e-23
        1.7515000000e-23
        9.5448000000e-24
        5.2091000000e-24
        6.0643000000e-24
        5.1244000000e-24
        4.3455000000e-24
        3.3736000000e-24
        2.9830000000e-24
        2.7568000000e-24
        2.3456000000e-24
        2.2404000000e-24
        1.9199000000e-24
        1.8286000000e-24
        1.5128000000e-24
        1.4448000000e-24
        1.3347000000e-24
        1.4011000000e-24
        1.4180000000e-24
        1.4472000000e-24
        1.5754000000e-24
        1.7684000000e-24
        1.9534000000e-24
        2.2796000000e-24
        2.7514000000e-24
        3.7797000000e-24
        6.9923000000e-24
        5.1345000000e-24
        4.9675000000e-24
        3.5664000000e-24
        2.7254000000e-24
        2.2596000000e-24
        1.9824000000e-24
        1.8526000000e-24
        1.8251000000e-24
        1.9844000000e-24
        2.2528000000e-24
        1.7973000000e-24
        1.6877000000e-24
        1.2572000000e-24
        1.0639000000e-24
        9.5542000000e-25
        8.7083000000e-25
        7.6325000000e-25
        6.9362000000e-25
        7.0208000000e-25
        7.8154000000e-25
        7.2221000000e-25
        4.7471000000e-25
        0.0000000000e+00
        0.0000000000e+00
        0.0000000000e+00
        0.0000000000e+00
        0.0000000000e+00
        ];
end